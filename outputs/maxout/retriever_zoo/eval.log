2026-01-09 00:19:22 | INFO | final_sc_review.data.io | Loaded 30028 sentences
2026-01-09 00:19:28 | INFO | final_sc_review.data.io | Loaded 298900 groundtruth rows
2026-01-09 00:19:28 | INFO | final_sc_review.data.io | Loaded 10 criteria
2026-01-09 00:19:30 | INFO | final_sc_review.retriever.bge_m3 | Loading BGE-M3 model BAAI/bge-m3 on cuda
Loading data...
Split: val (148 posts)
Total queries: 1480
Queries with positives: 135

Initializing retriever zoo...
Evaluating retrievers: ['bge-m3', 'bge-large-en-v1.5', 'e5-large-v2', 'bm25']

============================================================
Evaluating: bge-m3
============================================================
Encoding corpus...
Fetching 30 files:   0%|          | 0/30 [00:00<?, ?it/s]Fetching 30 files: 100%|██████████| 30/30 [00:00<00:00, 42395.26it/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
2026-01-09 00:19:45 | INFO | final_sc_review.retriever.zoo | Loading dense model: BAAI/bge-large-en-v1.5
2026-01-09 00:19:59 | INFO | final_sc_review.retriever.zoo | Encoding 30028 sentences with bge-large-en-v1.5
Computing oracle recall...
Computing ranking metrics...
Oracle Recall@200: 1.0000
nDCG@10: 0.6589
MRR@10: 0.5928

============================================================
Evaluating: bge-large-en-v1.5
============================================================
Encoding corpus...
Batches:   0%|          | 0/470 [00:00<?, ?it/s]Batches:   0%|          | 1/470 [00:00<04:08,  1.89it/s]Batches:   1%|          | 3/470 [00:00<01:51,  4.20it/s]Batches:   1%|          | 4/470 [00:00<01:40,  4.64it/s]Batches:   1%|          | 5/470 [00:01<01:26,  5.40it/s]Batches:   1%|▏         | 7/470 [00:01<00:58,  7.94it/s]Batches:   2%|▏         | 9/470 [00:01<00:45, 10.04it/s]Batches:   2%|▏         | 11/470 [00:01<00:38, 11.77it/s]Batches:   3%|▎         | 13/470 [00:01<00:33, 13.48it/s]Batches:   3%|▎         | 15/470 [00:01<00:31, 14.31it/s]Batches:   4%|▎         | 17/470 [00:01<00:29, 15.58it/s]Batches:   4%|▍         | 19/470 [00:01<00:27, 16.26it/s]Batches:   4%|▍         | 21/470 [00:02<00:26, 17.00it/s]Batches:   5%|▍         | 23/470 [00:02<00:25, 17.56it/s]Batches:   5%|▌         | 25/470 [00:02<00:25, 17.47it/s]Batches:   6%|▌         | 27/470 [00:02<00:24, 17.89it/s]Batches:   6%|▌         | 29/470 [00:02<00:24, 18.23it/s]Batches:   7%|▋         | 31/470 [00:02<00:24, 18.10it/s]Batches:   7%|▋         | 33/470 [00:02<00:24, 17.97it/s]Batches:   7%|▋         | 35/470 [00:02<00:23, 18.40it/s]Batches:   8%|▊         | 37/470 [00:02<00:23, 18.73it/s]Batches:   8%|▊         | 39/470 [00:02<00:22, 18.88it/s]Batches:   9%|▊         | 41/470 [00:03<00:22, 18.94it/s]Batches:   9%|▉         | 43/470 [00:03<00:22, 19.14it/s]Batches:  10%|▉         | 46/470 [00:03<00:20, 20.22it/s]Batches:  10%|█         | 49/470 [00:03<00:20, 20.91it/s]Batches:  11%|█         | 52/470 [00:03<00:19, 21.44it/s]Batches:  12%|█▏        | 55/470 [00:03<00:19, 21.58it/s]Batches:  12%|█▏        | 58/470 [00:03<00:18, 21.75it/s]Batches:  13%|█▎        | 61/470 [00:03<00:18, 22.70it/s]Batches:  14%|█▎        | 64/470 [00:04<00:16, 24.50it/s]Batches:  14%|█▍        | 67/470 [00:04<00:16, 24.76it/s]Batches:  15%|█▍        | 70/470 [00:04<00:16, 24.00it/s]Batches:  16%|█▌        | 74/470 [00:04<00:15, 26.40it/s]Batches:  17%|█▋        | 78/470 [00:04<00:14, 27.70it/s]Batches:  17%|█▋        | 82/470 [00:04<00:13, 28.67it/s]Batches:  18%|█▊        | 85/470 [00:04<00:13, 27.87it/s]Batches:  19%|█▉        | 89/470 [00:04<00:13, 28.74it/s]Batches:  20%|█▉        | 93/470 [00:05<00:12, 29.50it/s]Batches:  21%|██        | 97/470 [00:05<00:12, 30.11it/s]Batches:  21%|██▏       | 101/470 [00:05<00:12, 30.74it/s]Batches:  22%|██▏       | 105/470 [00:05<00:11, 31.36it/s]Batches:  23%|██▎       | 109/470 [00:05<00:11, 31.55it/s]Batches:  24%|██▍       | 113/470 [00:05<00:11, 29.93it/s]Batches:  25%|██▍       | 117/470 [00:05<00:11, 30.49it/s]Batches:  26%|██▌       | 121/470 [00:05<00:11, 31.02it/s]Batches:  27%|██▋       | 125/470 [00:06<00:11, 31.35it/s]Batches:  27%|██▋       | 129/470 [00:06<00:10, 31.77it/s]Batches:  28%|██▊       | 133/470 [00:06<00:11, 30.36it/s]Batches:  29%|██▉       | 137/470 [00:06<00:10, 31.27it/s]Batches:  30%|███       | 141/470 [00:06<00:10, 31.81it/s]Batches:  31%|███       | 145/470 [00:06<00:10, 32.21it/s]Batches:  32%|███▏      | 149/470 [00:06<00:09, 32.47it/s]Batches:  33%|███▎      | 153/470 [00:06<00:09, 32.32it/s]Batches:  33%|███▎      | 157/470 [00:07<00:09, 32.28it/s]Batches:  34%|███▍      | 161/470 [00:07<00:09, 33.07it/s]Batches:  35%|███▌      | 165/470 [00:07<00:09, 33.35it/s]Batches:  36%|███▌      | 169/470 [00:07<00:08, 34.06it/s]Batches:  37%|███▋      | 173/470 [00:07<00:08, 35.01it/s]Batches:  38%|███▊      | 177/470 [00:07<00:08, 35.08it/s]Batches:  39%|███▊      | 181/470 [00:07<00:08, 32.46it/s]Batches:  39%|███▉      | 185/470 [00:07<00:08, 32.83it/s]Batches:  40%|████      | 189/470 [00:08<00:08, 34.03it/s]Batches:  41%|████      | 193/470 [00:08<00:08, 32.83it/s]Batches:  42%|████▏     | 197/470 [00:08<00:07, 34.46it/s]Batches:  43%|████▎     | 201/470 [00:08<00:07, 35.55it/s]Batches:  44%|████▎     | 205/470 [00:08<00:07, 35.57it/s]Batches:  44%|████▍     | 209/470 [00:08<00:07, 36.19it/s]Batches:  45%|████▌     | 213/470 [00:08<00:07, 36.09it/s]Batches:  46%|████▌     | 217/470 [00:08<00:06, 36.81it/s]Batches:  47%|████▋     | 221/470 [00:08<00:06, 37.36it/s]Batches:  48%|████▊     | 225/470 [00:09<00:06, 36.88it/s]Batches:  49%|████▊     | 229/470 [00:09<00:06, 37.12it/s]Batches:  50%|████▉     | 233/470 [00:09<00:06, 37.80it/s]Batches:  51%|█████     | 238/470 [00:09<00:06, 38.30it/s]Batches:  52%|█████▏    | 243/470 [00:09<00:05, 39.27it/s]Batches:  53%|█████▎    | 247/470 [00:09<00:05, 38.53it/s]Batches:  53%|█████▎    | 251/470 [00:09<00:05, 38.45it/s]Batches:  54%|█████▍    | 255/470 [00:09<00:05, 37.98it/s]Batches:  55%|█████▌    | 259/470 [00:09<00:05, 38.37it/s]Batches:  56%|█████▌    | 263/470 [00:10<00:05, 38.66it/s]Batches:  57%|█████▋    | 268/470 [00:10<00:04, 40.47it/s]Batches:  58%|█████▊    | 273/470 [00:10<00:04, 41.63it/s]Batches:  59%|█████▉    | 278/470 [00:10<00:04, 41.18it/s]Batches:  60%|██████    | 283/470 [00:10<00:04, 41.96it/s]Batches:  61%|██████▏   | 288/470 [00:10<00:04, 41.72it/s]Batches:  62%|██████▏   | 293/470 [00:10<00:04, 42.37it/s]Batches:  63%|██████▎   | 298/470 [00:10<00:03, 43.64it/s]Batches:  64%|██████▍   | 303/470 [00:10<00:03, 44.04it/s]Batches:  66%|██████▌   | 308/470 [00:11<00:03, 44.91it/s]Batches:  67%|██████▋   | 313/470 [00:11<00:03, 45.40it/s]Batches:  68%|██████▊   | 318/470 [00:11<00:03, 44.21it/s]Batches:  69%|██████▊   | 323/470 [00:11<00:03, 43.46it/s]Batches:  70%|██████▉   | 328/470 [00:11<00:03, 44.74it/s]Batches:  71%|███████   | 333/470 [00:11<00:02, 46.00it/s]Batches:  72%|███████▏  | 338/470 [00:11<00:02, 46.74it/s]Batches:  73%|███████▎  | 343/470 [00:11<00:02, 47.01it/s]Batches:  74%|███████▍  | 348/470 [00:11<00:02, 45.63it/s]Batches:  75%|███████▌  | 354/470 [00:12<00:02, 47.25it/s]Batches:  76%|███████▋  | 359/470 [00:12<00:02, 47.22it/s]Batches:  77%|███████▋  | 364/470 [00:12<00:02, 47.05it/s]Batches:  79%|███████▊  | 370/470 [00:12<00:02, 47.21it/s]Batches:  80%|███████▉  | 375/470 [00:12<00:02, 45.74it/s]Batches:  81%|████████  | 381/470 [00:12<00:01, 47.90it/s]Batches:  82%|████████▏ | 387/470 [00:12<00:01, 48.79it/s]Batches:  84%|████████▎ | 393/470 [00:12<00:01, 49.65it/s]Batches:  85%|████████▍ | 399/470 [00:12<00:01, 50.31it/s]Batches:  86%|████████▌ | 405/470 [00:13<00:01, 51.74it/s]Batches:  87%|████████▋ | 411/470 [00:13<00:01, 53.21it/s]Batches:  89%|████████▊ | 417/470 [00:13<00:00, 55.03it/s]Batches:  90%|█████████ | 423/470 [00:13<00:00, 55.47it/s]Batches:  91%|█████████▏| 429/470 [00:13<00:00, 56.36it/s]Batches:  93%|█████████▎| 436/470 [00:13<00:00, 58.98it/s]Batches:  94%|█████████▍| 442/470 [00:13<00:00, 59.04it/s]Batches:  96%|█████████▌| 449/470 [00:13<00:00, 60.26it/s]Batches:  97%|█████████▋| 456/470 [00:13<00:00, 61.11it/s]Batches:  99%|█████████▊| 463/470 [00:14<00:00, 56.18it/s]Batches: 100%|██████████| 470/470 [00:14<00:00, 59.15it/s]Batches: 100%|██████████| 470/470 [00:14<00:00, 33.18it/s]
2026-01-09 00:20:18 | INFO | final_sc_review.retriever.zoo | Loading dense model: intfloat/e5-large-v2
2026-01-09 00:20:32 | INFO | final_sc_review.retriever.zoo | Encoding 30028 sentences with e5-large-v2
Computing oracle recall...
Computing ranking metrics...
Oracle Recall@200: 1.0000
nDCG@10: 0.6693
MRR@10: 0.6034

============================================================
Evaluating: e5-large-v2
============================================================
Encoding corpus...
Batches:   0%|          | 0/470 [00:00<?, ?it/s]Batches:   0%|          | 1/470 [00:00<03:40,  2.13it/s]Batches:   1%|          | 3/470 [00:00<01:43,  4.51it/s]Batches:   1%|          | 4/470 [00:00<01:36,  4.85it/s]Batches:   1%|          | 5/470 [00:01<01:23,  5.59it/s]Batches:   1%|▏         | 7/470 [00:01<00:58,  7.85it/s]Batches:   2%|▏         | 9/470 [00:01<00:46,  9.91it/s]Batches:   2%|▏         | 11/470 [00:01<00:39, 11.58it/s]Batches:   3%|▎         | 13/470 [00:01<00:34, 13.24it/s]Batches:   3%|▎         | 15/470 [00:01<00:32, 14.08it/s]Batches:   4%|▎         | 17/470 [00:01<00:29, 15.28it/s]Batches:   4%|▍         | 19/470 [00:01<00:28, 15.96it/s]Batches:   4%|▍         | 21/470 [00:01<00:26, 16.71it/s]Batches:   5%|▍         | 23/470 [00:02<00:25, 17.39it/s]Batches:   5%|▌         | 25/470 [00:02<00:25, 17.29it/s]Batches:   6%|▌         | 27/470 [00:02<00:24, 17.77it/s]Batches:   6%|▌         | 29/470 [00:02<00:24, 18.17it/s]Batches:   7%|▋         | 31/470 [00:02<00:24, 17.95it/s]Batches:   7%|▋         | 33/470 [00:02<00:24, 17.86it/s]Batches:   7%|▋         | 35/470 [00:02<00:23, 18.29it/s]Batches:   8%|▊         | 37/470 [00:02<00:23, 18.60it/s]Batches:   8%|▊         | 39/470 [00:02<00:22, 18.83it/s]Batches:   9%|▊         | 41/470 [00:03<00:22, 18.95it/s]Batches:   9%|▉         | 43/470 [00:03<00:22, 19.17it/s]Batches:  10%|▉         | 45/470 [00:03<00:22, 19.13it/s]Batches:  10%|█         | 47/470 [00:03<00:21, 19.34it/s]Batches:  10%|█         | 49/470 [00:03<00:29, 14.47it/s]Batches:  11%|█         | 52/470 [00:03<00:25, 16.68it/s]Batches:  11%|█▏        | 54/470 [00:03<00:23, 17.41it/s]Batches:  12%|█▏        | 57/470 [00:03<00:21, 19.00it/s]Batches:  13%|█▎        | 60/470 [00:04<00:20, 19.86it/s]Batches:  13%|█▎        | 63/470 [00:04<00:19, 20.56it/s]Batches:  14%|█▍        | 66/470 [00:04<00:18, 21.82it/s]Batches:  15%|█▍        | 69/470 [00:04<00:18, 21.80it/s]Batches:  15%|█▌        | 72/470 [00:04<00:17, 22.95it/s]Batches:  16%|█▌        | 76/470 [00:04<00:15, 25.31it/s]Batches:  17%|█▋        | 80/470 [00:04<00:14, 26.80it/s]Batches:  18%|█▊        | 83/470 [00:04<00:14, 26.22it/s]Batches:  19%|█▊        | 87/470 [00:05<00:13, 27.45it/s]Batches:  19%|█▉        | 91/470 [00:05<00:13, 28.69it/s]Batches:  20%|██        | 95/470 [00:05<00:12, 29.55it/s]Batches:  21%|██        | 99/470 [00:05<00:12, 29.88it/s]Batches:  22%|██▏       | 103/470 [00:05<00:12, 30.34it/s]Batches:  23%|██▎       | 107/470 [00:05<00:11, 30.54it/s]Batches:  24%|██▎       | 111/470 [00:05<00:11, 30.80it/s]Batches:  24%|██▍       | 115/470 [00:06<00:12, 28.34it/s]Batches:  25%|██▌       | 119/470 [00:06<00:11, 29.55it/s]Batches:  26%|██▌       | 123/470 [00:06<00:11, 30.20it/s]Batches:  27%|██▋       | 127/470 [00:06<00:11, 30.91it/s]Batches:  28%|██▊       | 131/470 [00:06<00:10, 31.09it/s]Batches:  29%|██▊       | 135/470 [00:06<00:11, 29.93it/s]Batches:  30%|██▉       | 139/470 [00:06<00:10, 30.52it/s]Batches:  30%|███       | 143/470 [00:06<00:10, 30.75it/s]Batches:  31%|███▏      | 147/470 [00:07<00:10, 31.12it/s]Batches:  32%|███▏      | 151/470 [00:07<00:10, 31.25it/s]Batches:  33%|███▎      | 155/470 [00:07<00:09, 31.56it/s]Batches:  34%|███▍      | 159/470 [00:07<00:09, 31.90it/s]Batches:  35%|███▍      | 163/470 [00:07<00:09, 32.02it/s]Batches:  36%|███▌      | 167/470 [00:07<00:09, 32.12it/s]Batches:  36%|███▋      | 171/470 [00:07<00:09, 32.73it/s]Batches:  37%|███▋      | 175/470 [00:07<00:08, 32.89it/s]Batches:  38%|███▊      | 179/470 [00:08<00:09, 31.04it/s]Batches:  39%|███▉      | 183/470 [00:08<00:09, 31.37it/s]Batches:  40%|███▉      | 187/470 [00:08<00:08, 32.05it/s]Batches:  41%|████      | 191/470 [00:08<00:09, 30.81it/s]Batches:  41%|████▏     | 195/470 [00:08<00:08, 32.33it/s]Batches:  42%|████▏     | 199/470 [00:08<00:08, 33.44it/s]Batches:  43%|████▎     | 203/470 [00:08<00:07, 34.25it/s]Batches:  44%|████▍     | 207/470 [00:08<00:07, 34.41it/s]Batches:  45%|████▍     | 211/470 [00:09<00:07, 35.06it/s]Batches:  46%|████▌     | 215/470 [00:09<00:07, 35.49it/s]Batches:  47%|████▋     | 219/470 [00:09<00:06, 36.29it/s]Batches:  47%|████▋     | 223/470 [00:09<00:06, 36.09it/s]Batches:  48%|████▊     | 227/470 [00:09<00:06, 36.68it/s]Batches:  49%|████▉     | 231/470 [00:09<00:06, 36.81it/s]Batches:  50%|█████     | 235/470 [00:09<00:06, 36.78it/s]Batches:  51%|█████     | 239/470 [00:09<00:06, 36.93it/s]Batches:  52%|█████▏    | 243/470 [00:09<00:06, 36.56it/s]Batches:  53%|█████▎    | 247/470 [00:10<00:06, 36.77it/s]Batches:  53%|█████▎    | 251/470 [00:10<00:06, 36.41it/s]Batches:  54%|█████▍    | 255/470 [00:10<00:05, 37.08it/s]Batches:  55%|█████▌    | 259/470 [00:10<00:05, 37.39it/s]Batches:  56%|█████▌    | 263/470 [00:10<00:05, 36.56it/s]Batches:  57%|█████▋    | 267/470 [00:10<00:05, 36.18it/s]Batches:  58%|█████▊    | 271/470 [00:10<00:05, 36.19it/s]Batches:  59%|█████▊    | 275/470 [00:10<00:05, 36.69it/s]Batches:  59%|█████▉    | 279/470 [00:10<00:05, 36.92it/s]Batches:  60%|██████    | 284/470 [00:10<00:04, 37.97it/s]Batches:  61%|██████▏   | 288/470 [00:11<00:04, 37.08it/s]Batches:  62%|██████▏   | 292/470 [00:11<00:04, 37.00it/s]Batches:  63%|██████▎   | 297/470 [00:11<00:04, 38.06it/s]Batches:  64%|██████▍   | 301/470 [00:11<00:04, 38.44it/s]Batches:  65%|██████▌   | 306/470 [00:11<00:04, 39.07it/s]Batches:  66%|██████▌   | 310/470 [00:11<00:04, 39.27it/s]Batches:  67%|██████▋   | 315/470 [00:11<00:03, 39.65it/s]Batches:  68%|██████▊   | 320/470 [00:11<00:03, 39.50it/s]Batches:  69%|██████▉   | 325/470 [00:12<00:03, 40.20it/s]Batches:  70%|███████   | 330/470 [00:12<00:03, 41.73it/s]Batches:  71%|███████▏  | 335/470 [00:12<00:03, 42.37it/s]Batches:  72%|███████▏  | 340/470 [00:12<00:02, 43.67it/s]Batches:  73%|███████▎  | 345/470 [00:12<00:02, 42.68it/s]Batches:  74%|███████▍  | 350/470 [00:12<00:02, 42.88it/s]Batches:  76%|███████▌  | 355/470 [00:12<00:02, 43.15it/s]Batches:  77%|███████▋  | 360/470 [00:12<00:02, 43.36it/s]Batches:  78%|███████▊  | 365/470 [00:12<00:02, 43.45it/s]Batches:  79%|███████▊  | 370/470 [00:13<00:02, 43.45it/s]Batches:  80%|███████▉  | 375/470 [00:13<00:02, 42.57it/s]Batches:  81%|████████  | 380/470 [00:13<00:02, 43.74it/s]Batches:  82%|████████▏ | 385/470 [00:13<00:01, 44.33it/s]Batches:  83%|████████▎ | 391/470 [00:13<00:01, 46.35it/s]Batches:  84%|████████▍ | 396/470 [00:13<00:01, 46.76it/s]Batches:  86%|████████▌ | 402/470 [00:13<00:01, 48.16it/s]Batches:  87%|████████▋ | 408/470 [00:13<00:01, 48.91it/s]Batches:  88%|████████▊ | 414/470 [00:13<00:01, 50.01it/s]Batches:  89%|████████▉ | 420/470 [00:14<00:00, 50.97it/s]Batches:  91%|█████████ | 426/470 [00:14<00:00, 51.23it/s]Batches:  92%|█████████▏| 432/470 [00:14<00:00, 52.13it/s]Batches:  93%|█████████▎| 438/470 [00:14<00:00, 53.09it/s]Batches:  94%|█████████▍| 444/470 [00:14<00:00, 53.32it/s]Batches:  96%|█████████▌| 450/470 [00:14<00:00, 53.49it/s]Batches:  97%|█████████▋| 456/470 [00:14<00:00, 54.08it/s]Batches:  99%|█████████▊| 463/470 [00:14<00:00, 55.96it/s]Batches: 100%|██████████| 470/470 [00:14<00:00, 59.67it/s]Batches: 100%|██████████| 470/470 [00:14<00:00, 31.39it/s]
Computing oracle recall...
Computing ranking metrics...
Oracle Recall@200: 1.0000
nDCG@10: 0.6377
MRR@10: 0.5575

============================================================
Evaluating: bm25
============================================================
Encoding corpus...
ERROR: Failed to initialize bm25: rank_bm25 is required. Install with: pip install rank-bm25

============================================================
RESULTS SUMMARY
============================================================

Retriever                 Oracle@200   nDCG@10    MRR@10    
------------------------------------------------------------
bge-m3                    1.0000       0.6589     0.5928    
bge-large-en-v1.5         1.0000       0.6693     0.6034    
e5-large-v2               1.0000       0.6377     0.5575    
bm25                      ERROR: rank_bm25 is required. Install

Top 3 by Oracle Recall@200:
  1. bge-m3: 1.0000
  2. bge-large-en-v1.5: 1.0000
  3. e5-large-v2: 1.0000

Results saved to: outputs/maxout/retriever_zoo/retriever_zoo_results.json
Report saved to: outputs/maxout/retriever_zoo/retrieval_zoo_report.md
